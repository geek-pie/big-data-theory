# 事实与维度

如果一笔交易，那么交易本身就是事实表。交易的产品就是维度表。

在数据库的设计中，很显然没有事实与维度表。那么在BI为什么会有？





先来看一看数据三范式：

## 第一范式（1NF)

所谓第一范式（1NF）是指在关系模型中，对于添加的一个规范要求，所有的域都应该是原子性的，即数据库表的每一列都是不可分割的原子数据项，而不能是集合，数组，记录等非原子数据项。即实体中的某个属性有多个值时，必须拆分为不同的属性。在符合第一范式（1NF）表中的每个域值只能是实体的一个属性或一个属性的一部分。简而言之，第一范式就是无重复的域。

在任何一个关系数据库中，第一范式（1NF）是对关系模式的设计基本要求，一般设计中都必须满足第一范式（1NF）。不过有些关系模型中突破了1NF的限制，这种称为非1NF的关系模型。换句话说，是否必须满足1NF的最低要求，主要依赖于所使用的关系模型。

特点：属性不可分割，即每个属性都是不可分割的原子项。(实体的属性即表中的列)



## 第二范式（2NF)

第二范式强调的是完全函数依赖。

第二范式（Second Normal Form, 2nd NF）是指每个表必须有主关键字（Primary key），其他数据元素与主关键字一一对应。通常称这种关系为函数依赖（Functional dependence）关系，即表中其他数据元素都依赖于主关键字，或称该数据元素惟一地被主关键字所标识。

简单地理解，2NF就是所有非主键字段都要依赖于整个主键，而不是其中的一部分。

第二范式的两个必要条件：首先要满足第一范式；每一个非主属性都完全函数依赖于任何一个主键。

- 满足第一范式；
- 第二范式需要确保数据表中的每一列都和主键相关，而不能只与主键的某一部分相关（主要针对联合主键而言），每张表只描述一件事情；
- 消除部分依赖，要求一张表中的每一列都完全依赖于主键（针对于组合主键），也就是不会出现某一列只和部分主键相关。



## 第三范式(3NF)

在2NF基础上，任何非主属性不依赖于其它非主属性（在2NF基础上消除传递依赖）。

第三范式（3NF）是第二范式（2NF）的一个子集，即满足第三范式（3NF）必须满足第二范式（2NF）。简而言之，第三范式（3NF）要求一个关系中不包含已在其它关系已包含的非主关键字信息。例如，存在一个部门信息表，其中每个部门有部门编号（dept_id）、部门名称、部门简介等信息。那么在员工信息表中列出部门编号后就不能再将部门名称、部门简介等与部门有关的信息再加入员工信息表中。如果不存在部门信息表，则根据第三范式（3NF）也应该构建它，否则就会有大量的数据冗余。简而言之，第三范式就是属性不依赖于其它非主属性，也就是在满足2NF的基础上，任何非主属性不得传递依赖于主属性。

特点：

- 前提：满足第一范式和第二范式；
- 第三范式需要确保数据表中的每一列数据表和主键直接相关，而不能间接相关；
- 消除传递依赖，要求一张表中的每一列都和主键是直接依赖的，不是间接依赖。

[关于数据冗余与范式化设计的思考-阿里云开发者社区](https://developer.aliyun.com/article/577963)











在数仓（data warehouse）中，事实表（fact table）和维度表（dimension table）是用来组织和存储大量事实数据的关键表。事实表包含多个度量（measure）列，用于记录数值型数据，比如销售数量、收入等。维度表包含多个维度（dimension）列，用于描述度量数据的上下文，比如时间、地点、产品等。

这种概念在数仓中的引入主要基于以下几点原因：

1. **提升查询性能：** 在数据仓库中，通常需要进行复杂的查询和分析。将事实数据和其相关的维度数据进行分离，可以通过建立关联关系来提升查询性能和灵活性。事实表中的数据可以通过与维度表的连接来进行更高效的精确查找。

2. **支持多维分析：** 数据仓库的目标之一是支持多维分析（OLAP）。维度表提供了多个维度，可以用来对事实数据进行多角度的分析和切片。

3. **简化数据模型：** 在数据仓库中，事实表通常是以星型模型或雪花模型的形式组织的，而维度表则用来扩展和描述事实表中的数据。这种设计模式可以简化数据模型，提高数据的清晰度和可维护性。

相比之下，数据库设计范式（如第一范式、第二范式等）更关注数据的规范性和无重复，而没有明确区分事实和维度。数据库设计范式主要用来规范关系型数据库中的数据关系，确保数据的一致性和完整性。简单的数据库应用可以通过遵循范式来设计，但对于复杂的分析需求和多维数据，数仓中引入了事实表和维度表的概念，以满足更高级的查询和分析需求



可以看到，设计的时候，比如交易表，那么完全可以不需要产品表。但是这个在产品设计上显然是不合理的。



与DDD一样，事实表与维度表是一种设计理念。



关键词"事实表"和"维度表"与数仓的相关概念有关，这些概念通常在与数据仓库和商业智能相关的教材中讨论。其中一本与数仓相关的经典教材是《The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling》（数据仓库工具包：面向维度建模的权威指南），该书由Ralph Kimball和Margy Ross撰写。这本书是维度建模的指南，包括了事实表、维度表等概念和技术。其他与数仓相关的教材也有涵盖这些关键词的内容，可以根据具体的书籍进行了解和学习。

维度和指标

元数据

数据域

、数据主题、

数据集市

和数据标签

对于数据中台来说，主要基础设施包含数据存储平台、数据计算平台和数据查询平台。

1）实时聚合计算。通过高效的聚合计算引擎完成需求的实时计算，然后通过查询引擎进行查询和取数操作。常见的高效的聚合计算引擎有Presto、Impala、ClickHouse等。（2）预计算。利用类似于Kylin的计算引擎提前将维度和指标计算好，然后通过高效的查询引擎支持取数操作。

推荐书籍

《数据中台建设：从方法论到落地实战》。

《数据仓库工具包：面向维度建模的权威指南》
